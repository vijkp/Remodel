cscope 15 $HOME/Remodel               0000008439
	@Makefile

2 
	gCC
 = 
gcc


3 
CFLAGS
 = -
D
 
DEBUG


5 
objs
 = 
maö
.
o
 
misc
.ÿ
fûe
.o

6 
§cs
 = 
maö
.
c
 
misc
.¯misc.
h
 
fûe
.h file.h

8 
ªmodñ
: 
CFLAGS
 = -
D
 
DEBUG
 -
ggdb
 -
g3


9 
nd
: 
CFLAGS
 = -
D
 
NON_DEBUG
 -
ggdb
 -
g3


11 
Æl
: 
ªmodñ


12 
nd
: 
ªmodñ
-nd

13 
ªmodñ
: 
$
(
objs
)

14 
$
(
CC
Ë$(
CFLAGS
Ë$(
objs
Ë-
o
 
ªmodñ
.
√w


15 
mv
 -
f
 
ªmodñ
.
√w
Ñemodel

17 #n⁄-
debug
 
buûd


18 
ªmodñ
-
nd
: 
$
(
objs
)

19 
$
(
CC
Ë$(
CFLAGS
Ë$(
objs
Ë-
o
 
ªmodñ
.
√w


20 
mv
 -
f
 
ªmodñ
.
√w
Ñemodel

22 
˛ón
:

23 
rm
 -
fv
 
ªmodñ
 *.
o


25 #IndividuÆ 
obje˘
 
fûe
 
™d
 
dïídícõs


26 
maö
.
o
: maö.
c
 
misc
.
h


27 
$
(
CC
Ë$(
CFLAGS
Ë-
c
 
maö
.¯-
o
 main.o

28 
misc
.
o
: misc.
c
 misc.
h


29 
$
(
CC
Ë$(
CFLAGS
Ë-
c
 
misc
.¯-
o
 misc.o

30 
fûe
.
o
: fûe.
c
 
misc
.
h
 file.h

31 
$
(
CC
Ë$(
CFLAGS
Ë-
c
 
fûe
.¯-
o
 file.o

	@file.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

4 
	~"fûe.h
"

5 
	~"misc.h
"

7 
îr‹_t
 
	$fûe_¥o˚ss_ªmodñfûe
() {

8 
FILE
 *
fh
;

9 
îr‹_t
 
ªt
 = 0;

11 i‡((
ªt
 = 
	`fûe_gë_ªmodñfûe
(&
fh
)Ë!
SUCCESS
) {

12 
	`c⁄_log
("RemodelfileÇot found\n");

13  
ªt
;

16 i‡((
ªt
 = 
	`fûe_ªad_ªmodñfûe
(&
fh
)Ë!
SUCCESS
) {

17  
ªt
;

20  
ªt
;

21 
	}
}

23 
îr‹_t
 
	$fûe_gë_ªmodñfûe
(
FILE
 **
ªmodñ_fh
) {

24 
îr‹_t
 
ªt
 = 
RM_NOFILEENT
;

27 *
ªmodñ_fh
 = 
	`f›í
("Remodelfile", "r");

28 i‡(*
ªmodñ_fh
 !
NULL
) {

29 
	`c⁄_log
("'Remodelfile' file found.\n");

30 
ªt
 = 
SUCCESS
;

31 
found
;

33 *
ªmodñ_fh
 = 
	`f›í
("remodelfile", "r");

34 i‡(*
ªmodñ_fh
 !
NULL
) {

35 
	`c⁄_log
("'remodelfile' file found.\n");

36 
ªt
 = 
SUCCESS
;

37 
found
;

39  
ªt
;

40 
found
:

41  
ªt
;

42 
	}
}

44 
îr‹_t
 
	$fûe_ªad_ªmodñfûe
(
FILE
 **
fh
) {

45 *
löe
 = 
NULL
;

46 
fsize
;

47 
size_t
 
Àn
=0;

48 
ssize_t
 
ªad
;

49 
îr‹_t
 
ªt
 = 0;

51 (
ªad
 = 
	`gëlöe
(&
löe
, &
Àn
, *
fh
)) != -1) {

52 
	`fûe_∑r£_löe
(
löe
);

53 
	`c⁄_log
("buf„r: %s", 
löe
);

55 
	`‰ì
(
löe
);

56  
ªt
;

57 
	}
}

59 
	$fûe_∑r£_löe
(*
löe
) {

60 
èrgë_«me_°rög
[128];

61 *
dïídícy_°rög
;

62 *
comm™d_°rög
;

63 
size_t
 
Àn
;

65 
Àn
 = 
	`°æí
(
löe
);

66 
	`debug_log
("löêÀngth %d\n", 
Àn
);

71 
	}
}

	@file.h

1 #i‚de‡
FILE_H


2 
	#FILE_H


	)

3 
	~"maödefs.h
"

4 
	~"misc.h
"

6 
îr‹_t
 
fûe_¥o˚ss_ªmodñfûe
();

7 
îr‹_t
 
fûe_gë_ªmodñfûe
(
FILE
 **);

8 
îr‹_t
 
fûe_ªad_ªmodñfûe
(
FILE
 **);

9 
fûe_¥o˚ss_löe
(*
löe
);

	@main.c

2 
	~<°dio.h
>

3 
	~<°dlib.h
>

6 
	~"maödefs.h
"

7 
	~"misc.h
"

8 
	~"fûe.h
"

10 
	$maö
(
¨gc
, **
¨gv
) {

11 
îr‹_t
 
ªsu…
;

12 
èrgë_t
 *
hód
;

14 
ªsu…
 = 
	`fûe_¥o˚ss_ªmodñfûe
();

15 i‡(
ªsu…
 !
SUCCESS
) {

16 
	`c⁄_log
("Process Remodelfile failed\n");

17  
ªsu…
;

20  
SUCCESS
;

21 
	}
}

	@maindefs.h

1 #i‚de‡
MAINDEFS_H


2 
	#MAINDEFS_H


	)

4 
	~<°dlib.h
>

5 
	~"ty≥.h
"

6 
	~<°dio.h
>

8 
	gdïídícy_t
;

9 
	gèrgë_t
;

10 
	g§c_fûe_t
;

13 
	mDP_TARGET
,

14 
	mDP_§c


15 } 
	tdp_ty≥_t
;

17 
	s§c_fûe_
 {

18 
	mfûï©h
[256];

19 
	mmd5hash
[32];

20 
boﬁ
 
	mis_buût
;

21 
§c_fûe_
 *
	m√xt
;

22 } 
	t§c_fûe_t
;

24 
	sdïídícy_
 {

25 
dp_ty≥_t
 
	mty≥
;

26 *
	mdp
;

27 
dïídícy_
 *
	m√xt
;

28 } 
	tdïídícy_t
;

30 
	sèrgë_
 {

31 
	m«me
[128];

32 
dïídícy_t
 *
	mdï_li°
;

33 *
	mcomm™d
;

34 
èrgë_
 *
	m√xt
;

35 } 
	tèrgë_t
;

	@misc.c

1 
	~<°dio.h
>

2 
	~<°d¨g.h
>

3 
	~<°rög.h
>

5 
	$debug_log_
(*
fûíame
, 
 
, c⁄° *
f‹m©
, ...) {

6 
va_li°
 
¨g
;

7 
ªsu…
;

8 
f‹m©_√w
[200];

10 
	`•rötf
(
f‹m©_√w
, "%s[%d]: %s", 
fûíame
, 
 
, 
f‹m©
);

11 
f‹m©
 = 
f‹m©_√w
;

12 
	`va_°¨t
(
¨g
, 
f‹m©
);

13 
ªsu…
 = 
	`v¥ötf
(
f‹m©
, 
¨g
);

14 
	`va_íd
(
¨g
);

15  
ªsu…
;

16 
	}
}

18 
	$c⁄_log
(c⁄° *
f‹m©
, ...) {

19 
va_li°
 
¨g
;

20 
ªsu…
;

21 
f‹m©_√w
[200];

23 
	`•rötf
(
f‹m©_√w
, "ªmodñ: %s", 
f‹m©
);

24 
f‹m©
 = 
f‹m©_√w
;

25 
	`va_°¨t
(
¨g
, 
f‹m©
);

26 
ªsu…
 = 
	`v¥ötf
(
f‹m©
, 
¨g
);

27 
	`va_íd
(
¨g
);

28  
ªsu…
;

29 
	}
}

	@misc.h

1 #i‚de‡
MISC_H


2 
	#MISC_H


	)

4 
	#TRUE
 1

	)

5 
	#FALSE
 0

	)

8 
	mSUCCESS
,

9 
	mRM_NOFILEENT
,

10 
	mRM_FAIL


11 } 
	tîr‹_t
;

13 
debug_log_
(*
fûíame
, 
 
, c⁄° *
f‹m©
, ...);

14 
c⁄_log
(c⁄° * 
fmt
, ...);

16 #ifde‡
DEBUG


17 
	#debug_log
(...Ë
	`debug_log_
(
__FILE__
, 
__LINE__
, 
__VA_ARGS__
)

	)

19 
	#debug_log
(...)

	)

	@tests/Makefile

1 
	gÆl
: 
¢≠


3 
¢≠
: 
obj
/
maö
.
o
 obj/
drivîs
.ÿobj/
fûesy°em
.ÿobj/
√tw‹k
.ÿobj/
sched
.o

4 
gcc
 
obj
/
maö
.
o
 obj/
drivîs
.ÿobj/
fûesy°em
.ÿobj/
√tw‹k
.ÿobj/
sched
.ÿ-ÿ
¢≠


6 
obj
/
maö
.
o
: maö.
c


7 
gcc
 -
c
 
maö
.¯-
o
 
obj
/main.o

9 
obj
/
drivîs
.
o
: drivîs.
c


10 
gcc
 -
c
 
drivîs
.¯-
o
 
obj
/drivers.o

12 
obj
/
fûesy°em
.
o
: fûesy°em.
c
 
sched
.
h


13 
gcc
 -
c
 
fûesy°em
.¯-
o
 
obj
/filesystem.o

15 
obj
/
√tw‹k
.
o
:Çëw‹k.
c
 
sched
.
h


16 
gcc
 -
c
 
√tw‹k
.¯-
o
 
obj
/network.o

18 
obj
/
sched
.
o
: sched.
c


19 
gcc
 -
c
 
sched
.¯-
o
 
obj
/sched.o

21 
˛ón
:

22 
rm
 -
rf
 
obj


	@tests/drivers.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~"drivîs.h
"

6 
	$drivîs_öô
() {

7 
a
;

8 
b
;

9 
c
;

10 
c
 = 
a
+
b
;

11 
	`¥ötf
("%†%d: %s()\n", 
__FILE__
, 
__LINE__
, 
__FUNCTION__
);

12 
	}
}

14 
	$drivîs_run
() {

15 
hñlo
 = 20;

16 
w‹ld
 = 10;

17 
hñlow‹ld
;

18 
hñlow‹ld
 = 
hñlo
 + 
w‹ld
;

19 
	`¥ötf
("%†%d: %s()\n", 
__FILE__
, 
__LINE__
, 
__FUNCTION__
);

20 
	}
}

22 
	$drivîs_upd©e
() {

23 
i
;

24 
j
;

25 
i
 = 20;

26 
j
 = 30;

27 
	`¥ötf
("%†%d: %s()\n", 
__FILE__
, 
__LINE__
, 
__FUNCTION__
);

28 
	}
}

	@tests/drivers.h

1 #i‚de‡
DRIVERS_H


2 
	#DRIVERS_H


	)

3 
	~<°dio.h
>

4 
	~<°dlib.h
>

6 
drivîs_öô
();

7 
drivîs_run
();

8 
drivîs_upd©e
();

	@tests/filesystem.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~"fûesy°em.h
"

4 
	~"sched.h
"

6 
	$fûesy°em_öô
() {

7 
	`sched_öô
();

8 
a
;

9 
b
;

10 
c
;

11 
c
 = 
a
+
b
;

12 
	`¥ötf
("%†%d: %s()\n", 
__FILE__
, 
__LINE__
, 
__FUNCTION__
);

13 
	}
}

15 
	$fûesy°em_run
() {

16 
hñlo
 = 20;

17 
w‹ld
 = 10;

18 
hñlow‹ld
;

19 
hñlow‹ld
 = 
hñlo
 + 
w‹ld
;

20 
	`¥ötf
("%†%d: %s()\n", 
__FILE__
, 
__LINE__
, 
__FUNCTION__
);

21 
	}
}

23 
	$fûesy°em_upd©e
() {

24 
	`sched_upd©e
();

25 
i
;

26 
j
;

27 
i
 = 20;

28 
j
 = 30;

29 
	`¥ötf
("%†%d: %s()\n", 
__FILE__
, 
__LINE__
, 
__FUNCTION__
);

30 
	}
}

	@tests/filesystem.h

1 #i‚de‡
FILESYSTEM_H


2 
	#FILESYSTEM_H


	)

4 
	~<°dio.h
>

5 
	~<°dlib.h
>

7 
fûesy°em_öô
();

8 
fûesy°em_run
();

9 
fûesy°em_upd©e
();

	@tests/main.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~"drivîs.h
"

4 
	~"√tw‹k.h
"

5 
	~"sched.h
"

6 
	~"fûesy°em.h
"

9 
	$maö
() {

10 
	`drivîs_öô
();

11 
	`drivîs_upd©e
();

12 
	`fûesy°em_öô
();

13 
	`fûesy°em_upd©e
();

14 
	`√tw‹k_öô
();

15 
	`√tw‹k_upd©e
();

17 
	}
}

	@tests/network.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~"√tw‹k.h
"

4 
	~"sched.h
"

6 
	$√tw‹k_öô
() {

7 
	`sched_öô
();

8 
a
;

9 
b
;

10 
c
;

11 
c
 = 
a
+
b
;

12 
	`¥ötf
("%†%d: %s()\n", 
__FILE__
, 
__LINE__
, 
__FUNCTION__
);

13 
	}
}

15 
	$√tw‹k_run
() {

16 
hñlo
 = 20;

17 
w‹ld
 = 10;

18 
hñlow‹ld
;

19 
hñlow‹ld
 = 
hñlo
 + 
w‹ld
;

20 
	`¥ötf
("%†%d: %s()\n", 
__FILE__
, 
__LINE__
, 
__FUNCTION__
);

21 
	}
}

23 
	$√tw‹k_upd©e
() {

24 
	`sched_upd©e
();

25 
i
;

26 
j
;

27 
i
 = 20;

28 
j
 = 30;

29 
	`¥ötf
("%†%d: %s()\n", 
__FILE__
, 
__LINE__
, 
__FUNCTION__
);

30 
	}
}

	@tests/network.h

1 #i‚de‡
NETWORK_H


2 
	#NETWORK_H


	)

4 
	~<°dio.h
>

5 
	~<°dlib.h
>

6 
√tw‹k_öô
();

7 
√tw‹k_run
();

8 
√tw‹k_upd©e
();

	@tests/sched.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~"sched.h
"

5 
	$sched_öô
() {

6 
a
;

7 
b
;

8 
c
;

9 
c
 = 
a
+
b
;

10 
	`¥ötf
("%†%d: %s()\n", 
__FILE__
, 
__LINE__
, 
__FUNCTION__
);

11 
	}
}

13 
	$sched_run
() {

14 
hñlo
 = 20;

15 
w‹ld
 = 10;

16 
hñlow‹ld
;

17 
hñlow‹ld
 = 
hñlo
 + 
w‹ld
;

18 
	`¥ötf
("%†%d: %s()\n", 
__FILE__
, 
__LINE__
, 
__FUNCTION__
);

19 
	}
}

21 
	$sched_upd©e
() {

22 
i
;

23 
j
;

24 
i
 = 20;

25 
j
 = 30;

26 
	`¥ötf
("%†%d: %s()\n", 
__FILE__
, 
__LINE__
, 
__FUNCTION__
);

27 
	}
}

	@tests/sched.h

1 #i‚de‡
SCHED_H


2 
	#SCHED_H


	)

3 
	~<°dio.h
>

4 
	~<°dlib.h
>

6 
sched_öô
();

7 
sched_run
();

8 
sched_upd©e
();

	@type.h

1 #i‚de‡
TYPE_H


2 
	#TYPE_H


	)

4 
_Boﬁ
 
	tboﬁ
;

	@
1
.
0
18
220
Makefile
file.c
file.h
main.c
maindefs.h
misc.c
misc.h
tests/Makefile
tests/drivers.c
tests/drivers.h
tests/filesystem.c
tests/filesystem.h
tests/main.c
tests/network.c
tests/network.h
tests/sched.c
tests/sched.h
type.h
